var tester = require("../src/tester.js"),
	assert = require("assert");

module.exports = {
	"tester": function () {
		assert(typeof tester === "function");
	},
	"tester on tests": function () {
		var tests = {
			"one": function () {
				assert(true);
			},
			"two": function () {
				assert(false, "failing assertion");
			}
		};

		var ret = tester(tests, { "noReport": true });
		assert(ret[0][0] === "one");
		assert(ret[1][0].message === "failing assertion");
	},
	"tester on async tests": function (done) {
		done(function (success, errors) {
			assert(success[0] === "one");
			console.log(errors[0].message);
			assert(errors[0].message === "failing assertion");
		});

		var tests = {
			"one": function (done) {
				done(function () {
					assert(true);
				});
				setTimeout(done, 100);
			},
			"two": function (done) {
				done(function () {
					assert(false, "failing assertion");
				});
				setTimeout(done, 100);
			}
		}

		tester(tests, { 
			"noReport": true,
			"cb": done
		});
	}
};

if (!module.parent) {
	tester(module.exports);	
}
